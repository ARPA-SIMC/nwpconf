<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.6"/>
<title>NWPconf: /lhome/lm_ope/nwpconf/bin/swan_model.sh File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">NWPconf
   &#160;<span id="projectnumber">Version1.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_2ea30aa2956a8db99dd22aa5e597f384.html">bin</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">swan_model.sh File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Module with functions specific to the SWAN model.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a9a7886e42803d11b6a0e49acd700f310"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="swan__model_8sh.html#a9a7886e42803d11b6a0e49acd700f310">swan_model_init</a> ()</td></tr>
<tr class="memdesc:a9a7886e42803d11b6a0e49acd700f310"><td class="mdescLeft">&#160;</td><td class="mdescRight">Setup the environment for SWAN model.  <a href="#a9a7886e42803d11b6a0e49acd700f310">More...</a><br/></td></tr>
<tr class="separator:a9a7886e42803d11b6a0e49acd700f310"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abc903b31b6b86d68ae8fd519108ad47d"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="abc903b31b6b86d68ae8fd519108ad47d"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>inputmodel_name</b> ($1)</td></tr>
<tr class="separator:abc903b31b6b86d68ae8fd519108ad47d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4282b37a37921036fe45eeb588284c9d"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="swan__model_8sh.html#a4282b37a37921036fe45eeb588284c9d">swan_compute_scanning_mode</a> ($1)</td></tr>
<tr class="memdesc:a4282b37a37921036fe45eeb588284c9d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Output the number to be used in the SWAN command file according to the scanning mode of the input grib file.  <a href="#a4282b37a37921036fe45eeb588284c9d">More...</a><br/></td></tr>
<tr class="separator:a4282b37a37921036fe45eeb588284c9d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac79072b73e3366c806c7e3798edd6cec"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="swan__model_8sh.html#ac79072b73e3366c806c7e3798edd6cec">swan_create_wind_input</a> ($1, $2)</td></tr>
<tr class="memdesc:ac79072b73e3366c806c7e3798edd6cec"><td class="mdescLeft">&#160;</td><td class="mdescRight">Generate an input file with wind field suitable for the SWAN model from an input file in grib format.  <a href="#ac79072b73e3366c806c7e3798edd6cec">More...</a><br/></td></tr>
<tr class="separator:ac79072b73e3366c806c7e3798edd6cec"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a94cec457e3cc9b0215d3ebce01d5a8e2"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="swan__model_8sh.html#a94cec457e3cc9b0215d3ebce01d5a8e2">swan_create_bathymetry</a> ($1, $2)</td></tr>
<tr class="memdesc:a94cec457e3cc9b0215d3ebce01d5a8e2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Generate an input file with bathymetry suitable for the SWAN model from an input file in grib format.  <a href="#a94cec457e3cc9b0215d3ebce01d5a8e2">More...</a><br/></td></tr>
<tr class="separator:a94cec457e3cc9b0215d3ebce01d5a8e2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a47a7e3980551dc776c5e5d865ad282fe"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="swan__model_8sh.html#a47a7e3980551dc776c5e5d865ad282fe">swan_make_grib</a> ($1-$n-1, $n)</td></tr>
<tr class="memdesc:a47a7e3980551dc776c5e5d865ad282fe"><td class="mdescLeft">&#160;</td><td class="mdescRight">Convert the SWAN gridded output into a file in grib format.  <a href="#a47a7e3980551dc776c5e5d865ad282fe">More...</a><br/></td></tr>
<tr class="separator:a47a7e3980551dc776c5e5d865ad282fe"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Module with functions specific to the SWAN model. </p>
<p>This module provides functions specific to the sea wave model <a href="http://www.swan.tudelft.nl/">SWAN</a>. Grid-related functions for SWAN support only regular latlon grids.</p>
<p>The following environmental variables should be set by the user when using the functions from present module:</p>
<ul>
<li><code>$SWAN_XMIN</code> indicates the minimum x coordinate of model domain (longitude of lower left corner of the model grid)</li>
<li><code>$SWAN_XMAX</code> indicates the maximum x coordinate of model domain (longitude of upper right corner of the model grid)</li>
<li><code>$SWAN_YMIN</code> indicates the minimum y coordinate of model domain (latitude of lower left corner of the model grid)</li>
<li><code>$SWAN_YMAX</code> indicates the maximum y coordinate of model domain (latitude of upper right corner of the model grid)</li>
<li><code>$SWAN_NX</code> indicates the number of intervals (number of points -1) in the model grid along the x axis</li>
<li><code>$SWAN_NY</code> indicates the number of intervals (number of points -1) in the model grid along the y axis </li>
</ul>
</div><h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="a9a7886e42803d11b6a0e49acd700f310"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">swan_model_init </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Setup the environment for SWAN model. </p>
<p>This functions is implicitly called when the module is sourced, it sets up the environment for SWAN model with reasonable defaults. </p>

</div>
</div>
<a class="anchor" id="a4282b37a37921036fe45eeb588284c9d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">swan_compute_scanning_mode </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$1</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Output the number to be used in the SWAN command file according to the scanning mode of the input grib file. </p>
<p>This function scans the input grib file provided, reads the scanning mode of the first message and prints on stdout a number (either 2, 4 or 6) describing the grib scanning mode in the convention required by the SWAN command file as described in <a href="http://swanmodel.sourceforge.net/online_doc/swanuse/node26.html">http://swanmodel.sourceforge.net/online_doc/swanuse/node26.html</a> parameter <em>idla</em> of command <em>READINP</em>, e.g. for wind and bathymetry input. If the scanning mode is not handled by SWAN, 0 is printed. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">$1</td><td>name of the grib file in input </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="ac79072b73e3366c806c7e3798edd6cec"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">swan_create_wind_input </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Generate an input file with wind field suitable for the SWAN model from an input file in grib format. </p>
<p>This function interpolates all the 10m wind fields encountered in the input grib file on the grid defined for SWAN and outputs them in a text format suitable to be read by the SWAN model. The fields are interpolated on the configured latlon regular grid (other types of SWAN grids are not supported) according to <code>$SWAN_NX</code>, <code>$SWAN_XMIN</code> etc. environmental variables. The input projections supported are those supported by libsim package; input wind components with different values of component flag (wind rotation) are supported. The input scanning mode (i.e. order of points in the grib fields) is assumed to be the same for all wind fields and an equivalent value in the SWAN convention is computed and assigned to the variable <code>$SWAN_WIND_SCMODE</code> to be used in the SWAN command file, see <em><a class="el" href="swan__model_8sh.html#a4282b37a37921036fe45eeb588284c9d" title="Output the number to be used in the SWAN command file according to the scanning mode of the input gri...">swan_compute_scanning_mode()</a></em> function.</p>
<p>The output text file should be read by SWAN using, in the command file, the key <code>EXC -99999.</code> in <code>INPGRID</code> command and the key <code>FORMAT "(19X,F17.0)"</code> in <code>READINP</code> command.</p>
<p>No check is made on the quantity and reference/forecast time of wind fields in input file, it is up to the user to make sure that they correspond to what SWAN expects. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">$1</td><td>input file name in grib format </td></tr>
    <tr><td class="paramname">$2</td><td>output file name in text format </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a94cec457e3cc9b0215d3ebce01d5a8e2"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">swan_create_bathymetry </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Generate an input file with bathymetry suitable for the SWAN model from an input file in grib format. </p>
<p>This function interpolates the field in the input grib file on the grid defined for SWAN and outputs it in a text format suitable to be read by the SWAN model. The field is interpolated on the configured latlon regular grid (other types of SWAN grids are not supported) according to <code>$SWAN_NX</code>, <code>$SWAN_XMIN</code> etc. environmental variables. The input projections supported are those supported by libsim package. The input scanning mode (i.e. order of points in the grib field) is read from the input file and an equivalent value in the SWAN convention is computed and assigned to the variable <code>$SWAN_BATHY_SCMODE</code> to be used in the SWAN command file, see <em><a class="el" href="swan__model_8sh.html#a4282b37a37921036fe45eeb588284c9d" title="Output the number to be used in the SWAN command file according to the scanning mode of the input gri...">swan_compute_scanning_mode()</a></em> function.</p>
<p>The output text file should be read by SWAN using, in the command file, the key <code>EXC -99999.</code> in <code>INPGRID</code> command and the key <code>FORMAT "(19X,F17.0)"</code> in <code>READINP</code> command.</p>
<p>The input grib file should contain only a single grib field with the height of earth surface/sea bottom above sea level in m, no check is made on the correctness of the parameter. Points having a missing value or a value greater than -0.1 m in the input file are set to a missing value (<code>EXC</code> key) in the output.</p>
<p>Notice that, if the field is coded as a topography height (i.e. with negative values in sea points), a value of <code>-1</code> for the <code>fac</code> key of the <code>READINP</code> command should be used in order to change the sign of the bathymetry values as expected by SWAN. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">$1</td><td>name of input file in grib format </td></tr>
    <tr><td class="paramname">$2</td><td>name of output file in text format </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a47a7e3980551dc776c5e5d865ad282fe"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">swan_make_grib </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$1-$n-</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$n</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Convert the SWAN gridded output into a file in grib format. </p>
<p>This function converts a set of plain text files, generated by the SWAN model on the computational regular latlon grid with a command like <code>TABLE 'COMPGRID'...</code>, into a grib file using the ECMWF local table 140. The file name is assumed to be in the form <code>&lt;dirname&gt;/&lt;prefix&gt;_&lt;param&gt;_&lt;suffix&gt;</code> where <code>&lt;prefix&gt;</code> must not contain underscore characters and the value of <code>&lt;param&gt;</code> is used as the grib indicator of parameter for the variable in the file. It is assumed that each input text file contains data from start to end of run (<code>$DATES$TIMES</code> <code>$DATEE$TIMEE</code>) strictly at hourly intervals and the grib timerange is coded in forecast or analysis mode depending on the type of the run. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">$1-$n-1</td><td>name of input plain text files </td></tr>
    <tr><td class="paramname">$n</td><td>name of output grib file </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.6
</small></address>
</body>
</html>
