<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.6"/>
<title>NWPconf: /lhome/lm_ope/nwpconf/bin/nwptime.sh File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">NWPconf
   &#160;<span id="projectnumber">Version1.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_2ea30aa2956a8db99dd22aa5e597f384.html">bin</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">nwptime.sh File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Module with functions for managing the reference time of NWP runs.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a2e643ad58c3dbcf572203d48ec60ddd5"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="nwptime_8sh.html#a2e643ad58c3dbcf572203d48ec60ddd5">nwptime_init</a> ()</td></tr>
<tr class="memdesc:a2e643ad58c3dbcf572203d48ec60ddd5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialise the time-related environment for a NWP run.  <a href="#a2e643ad58c3dbcf572203d48ec60ddd5">More...</a><br/></td></tr>
<tr class="separator:a2e643ad58c3dbcf572203d48ec60ddd5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a88f2657fd2748a3d2eb66065a967d2e4"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="nwptime_8sh.html#a88f2657fd2748a3d2eb66065a967d2e4">nwpbctimeloop_init</a> ()</td></tr>
<tr class="memdesc:a88f2657fd2748a3d2eb66065a967d2e4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialise a loop on the model runs providing input boundary conditions for a NWP run.  <a href="#a88f2657fd2748a3d2eb66065a967d2e4">More...</a><br/></td></tr>
<tr class="separator:a88f2657fd2748a3d2eb66065a967d2e4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afed3a256748dad602211d7c10ef4968c"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="nwptime_8sh.html#afed3a256748dad602211d7c10ef4968c">nwpbctimeloop_loop</a> ()</td></tr>
<tr class="memdesc:afed3a256748dad602211d7c10ef4968c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Advance a loop on the model runs providing input boundary conditions for a NWP run.  <a href="#afed3a256748dad602211d7c10ef4968c">More...</a><br/></td></tr>
<tr class="separator:afed3a256748dad602211d7c10ef4968c"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Module with functions for managing the reference time of NWP runs. </p>
<p>This module provides functions for performing various types of computations related to the reference and forecast time of a NWP model run and of the driving model data. Assimilation and forecast modes are supported, as well analysed and forecast boundary conditions with a desired reference time shift. The terms <em>input model</em> and <em>driving model</em> are used interchangeably hereafter.</p>
<p>The following environmental variables should be set in order to describe the model reference timing:</p>
<ul>
<li><code>$DATE</code> (YYYYMMDD) and <code>$TIME</code> (hhmm) indicate the current nominal date and time, i.e. the start of the run for a forecast run or the end of the run for an assimilation run</li>
<li><code>$MODEL_STOP</code> indicates the total absolute duration of the run in hours</li>
<li><code>$MODEL_BACK</code> indicates the number of hours to go back from <code>$DATE$TIME</code> for starting an assimilation or warm-up run, typical values are 0 for a forecast run and <code>$MODEL_BACK</code> for assimilation or warm-up, intermediate values between 0 and <code>$MODEL_BACK</code> may give unexpected results</li>
<li><code>$MODEL_BCANA</code> if set to <code>Y</code> indicates that analysis data are used as boundary conditions</li>
<li><code>$MODEL_DELTABD</code> indicates the difference in hours between <code>$DATE$TIME</code> and the initialisation time of last available input model forecast, it is ignored if <code>$MODEL_BCANA == Y</code></li>
<li><code>$PARENTMODEL_FREQANA</code> indicates the interval in hours between available analysis data from the driving model, used in the case of <code>$MODEL_BCANA == Y</code>, it is assumed that analyses are produced at 00 UTC and successively every <code>$PARENTMODEL_FREQANA</code> hours</li>
<li><code>$PARENTMODEL_FREQINI</code> indicates the interval in hours between initialisation of successive driving model forecasts, used in the case of <code>$MODEL_BCANA != Y</code>, it is assumed that forecasts are initialised at 00 UTC and successively every <code>$PARENTMODEL_FREQINI</code> hours</li>
<li><code>$PARENTMODEL_FREQFC</code> indicates the interval in hours between successive driving model forecast steps of a single forecast run, used in the case of <code>$MODEL_BCANA != Y</code></li>
</ul>
<p>It is an optional module and it has to be sourced after the main <em><a class="el" href="nwpconf_8sh.html" title="Main entry point for the NWPconf bash library. ">nwpconf.sh</a></em> module. </p>
</div><h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="a2e643ad58c3dbcf572203d48ec60ddd5"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">nwptime_init </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initialise the time-related environment for a NWP run. </p>
<p>This function is implicitly called when the module is sourced, it sets the following variables:</p>
<ul>
<li><code>$DATES</code> and <code>$TIMES</code> absolute date and time of start of model run, either assimilation or forecast, based on <code>$DATE</code>, <code>$TIME</code> and <code>$MODEL_BACK</code></li>
<li><code>$DATEE</code> and <code>$TIMEE</code> absolute date and time of end of model run, either assimilation or forecast, based on <code>$DATE</code>, <code>$TIME</code>, <code>$MODEL_BACK</code> and <code>$MODEL_STOP</code></li>
<li><code>$PARENTMODEL_FREQ</code> interval in h between available boundary conditions regardless of them being analysis or forecast </li>
</ul>

</div>
</div>
<a class="anchor" id="a88f2657fd2748a3d2eb66065a967d2e4"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">nwpbctimeloop_init </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initialise a loop on the model runs providing input boundary conditions for a NWP run. </p>
<p>This function has to be called for initialising a loop over the input model runs (called "slices") that provide the boundary conditions to an assimilation run. The most common cases are taken into account, like using analysed or forecast BC's, possibly with a shift in time and with specified frequency of availability. For the correct use see <em><a class="el" href="nwptime_8sh.html#afed3a256748dad602211d7c10ef4968c" title="Advance a loop on the model runs providing input boundary conditions for a NWP run. ">nwpbctimeloop_loop()</a></em>. </p>

</div>
</div>
<a class="anchor" id="afed3a256748dad602211d7c10ef4968c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">nwpbctimeloop_loop </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Advance a loop on the model runs providing input boundary conditions for a NWP run. </p>
<p>This function has to be called for advancing a loop over the model runs (called "slices") that provide the boundary conditions to an assimilation or forecast run. The function sets the variables:</p>
<ul>
<li><code>$DATES_SLICE</code> and <code>$TIMES_SLICE</code> date and time of start of current slice of input model providing BCs</li>
<li><code>$MODEL_START_SLICE</code> and <code>$MODEL_STOP_SLICE</code> indicate the first and the last instants, in h starting from <code>$DATES</code> and <code>$TIMES</code>, for which BCs are taken from current slice</li>
<li><code>$MODEL_FREQ_SLICE</code> interval in h between available instants (boundary conditions) for current slice (actually equal for every slice and equal to <code>$PARENTMODEL_FREQ</code>)</li>
<li><code>$MODEL_DELTABD_SLICE</code> difference in h between start of assimilation and start of current slice of input model providing BCs</li>
<li><code>$MODEL_INI_SLICE</code> whether current slice of input model may provide also initial data (<code>.TRUE.</code>) or only boundary data (<code>.FALSE.</code>).</li>
</ul>
<p>The return value is 1 (true) if the loop is not terminated, or 0 (false) if the loop is terminated, thus it should be used in the following way: </p>
<pre class="fragment">nwpbctimeloop_init
while nwpbctimeloop_loop; do
    performoperationsintheloop
done  </pre> 
</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.6
</small></address>
</body>
</html>
